<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modal Windows Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: #e0e0e0;
            font-family: 'Press Start 2P', monospace;
            font-size: 12px;
        }

        .test-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .test-btn {
            background: #2a2a2a;
            border: 2px solid #555555;
            color: #e0e0e0;
            padding: 10px 15px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .test-btn:hover {
            background: #3a3a3a;
            border-color: #D4AF37;
        }

        .resource-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .resource-item {
            background: #2a2a2a;
            border: 1px solid #555555;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .resource-item:hover {
            background: #3a3a3a;
            border-color: #D4AF37;
        }

        .debug-info {
            background: #2a2a2a;
            border: 1px solid #444;
            padding: 15px;
            margin-top: 20px;
            font-size: 10px;
        }

        .debug-info h3 {
            color: #D4AF37;
            margin-top: 0;
        }
    </style>
</head>
<body>
    <h1>Modal Windows Test</h1>

    <div class="test-buttons">
        <button class="test-btn" onclick="debugOpenPopulation()">üë• Population</button>
        <button class="test-btn" onclick="debugOpenHappiness()">üòä Happiness</button>
        <button class="test-btn" onclick="debugOpenInventory()">üì¶ Inventory</button>
        <button class="test-btn" onclick="debugOpenAbilities()">üß† Abilities</button>
        <button class="test-btn" onclick="debugOpenMenu()">‚ò∞ Menu</button>
        <button class="test-btn" onclick="closeAllModals()">‚ùå Close All</button>
    </div>

    <div class="resource-grid">
        <div class="resource-item" onclick="handleResourceClick('residents')">üë• Residents</div>
        <div class="resource-item" onclick="handleResourceClick('happiness')">üòä Happiness</div>
        <div class="resource-item" onclick="handleResourceClick('defense')">üõ°Ô∏è Defense</div>
        <div class="resource-item" onclick="handleResourceClick('ammo')">üî´ Ammo</div>
        <div class="resource-item" onclick="handleResourceClick('comfort')">üõãÔ∏è Comfort</div>
        <div class="resource-item" onclick="handleResourceClick('food')">üçñ Food</div>
        <div class="resource-item" onclick="handleResourceClick('water')">üíß Water</div>
        <div class="resource-item" onclick="handleResourceClick('money')">üí∞ Money</div>
        <div class="resource-item" onclick="handleResourceClick('enemies')">üëπ Enemies</div>
    </div>

    <div class="debug-info">
        <h3>Debug Information</h3>
        <p>Click on any resource above to test modal windows</p>
        <p>Use the buttons to test specific modals</p>
        <p>Check browser console for debug messages</p>
        <p id="status">Status: Ready</p>
    </div>

    <!-- Include the UI overlay -->
    <div id="game-ui-overlay"></div>

    <script>
        // Mock game data for testing
        const mockGameData = {
            day: 5,
            phase: 'day',
            time: '14:30',
            population: 8,
            capacity: 12,
            happiness: 75,
            defense: 65,
            ammo: 245,
            comfort: 80,
            food: 156,
            water: 134,
            money: 890,
            enemies: 3,
            bunkerLevel: 3,
            bunkerExperience: 67,
            maxExperience: 100
        };

        // Mock bunker residents
        const mockResidents = [
            { name: '–ê–ª–µ–∫—Å–µ–π', age: 32, gender: '–ú', profession: '–∏–Ω–∂–µ–Ω–µ—Ä', status: '—Ä–∞–±–æ—Ç–∞–µ—Ç', hunger: 85, thirst: 90, energy: 70 },
            { name: '–ú–∞—Ä–∏—è', age: 28, gender: '–ñ', profession: '–¥–æ–∫—Ç–æ—Ä', status: '–æ—Ç–¥—ã—Ö–∞–µ—Ç', hunger: 95, thirst: 88, energy: 60 },
            { name: '–î–º–∏—Ç—Ä–∏–π', age: 45, gender: '–ú', profession: '–æ—Ö–æ—Ç–Ω–∏–∫', status: '—Ä–∞–±–æ—Ç–∞–µ—Ç', hunger: 70, thirst: 75, energy: 80 },
            { name: '–ê–Ω–Ω–∞', age: 25, gender: '–ñ', profession: '—Ñ–µ—Ä–º–µ—Ä', status: '—Ä–∞–±–æ—Ç–∞–µ—Ç', hunger: 80, thirst: 85, energy: 75 },
            { name: '–°–µ—Ä–≥–µ–π', age: 38, gender: '–ú', profession: '—Å–æ–ª–¥–∞—Ç', status: '–æ—Ö—Ä–∞–Ω—è–µ—Ç', hunger: 60, thirst: 70, energy: 90 },
            { name: '–ï–ª–µ–Ω–∞', age: 30, gender: '–ñ', profession: '–ø–æ–≤–∞—Ä', status: '—Ä–∞–±–æ—Ç–∞–µ—Ç', hunger: 75, thirst: 80, energy: 65 },
            { name: '–ò–≤–∞–Ω', age: 22, gender: '–ú', profession: '—Ä–∞–∑–≤–µ–¥—á–∏–∫', status: '–æ—Ç–¥—ã—Ö–∞–µ—Ç', hunger: 90, thirst: 85, energy: 55 },
            { name: '–û–ª—å–≥–∞', age: 35, gender: '–ñ', profession: '—É—á–µ–Ω—ã–π', status: '—Ä–∞–±–æ—Ç–∞–µ—Ç', hunger: 85, thirst: 82, energy: 72 }
        ];

        let modalStatus = 'Ready';

        function updateStatus(message) {
            modalStatus = message;
            document.getElementById('status').textContent = 'Status: ' + message;
            console.log('[Test]', message);
        }

        // Initialize UI overlay
        document.addEventListener('DOMContentLoaded', function() {
            // Load the UI overlay content
            fetch('./src/ui/game-overlay.html')
                .then(response => response.text())
                .then(html => {
                    document.getElementById('game-ui-overlay').innerHTML = html;
                    updateStatus('UI overlay loaded successfully');

                    // Update UI with mock data
                    if (typeof updateGameUI === 'function') {
                        updateGameUI(mockGameData);
                    }

                    // Populate modals with mock data
                    setTimeout(() => {
                        if (typeof populatePopulationModal === 'function') {
                            populatePopulationModal(mockResidents);
                        }
                        updateStatus('Mock data loaded');
                    }, 500);
                })
                .catch(error => {
                    updateStatus('Failed to load UI overlay: ' + error.message);
                    console.error('Failed to load UI overlay:', error);
                });
        });

        function closeAllModals() {
            const modals = ['population-modal', 'resource-modal', 'inventory-modal', 'abilities-modal', 'menu-modal'];
            modals.forEach(modalId => {
                if (typeof closeModal === 'function') {
                    closeModal(modalId);
                }
            });
            updateStatus('All modals closed');
        }

        // Make functions globally available for testing
        window.debugOpenPopulation = function() {
            updateStatus('Opening population modal...');
            if (typeof openResidents === 'function') {
                openResidents();
            } else {
                updateStatus('openResidents function not available');
            }
        };

        window.debugOpenHappiness = function() {
            updateStatus('Opening happiness modal...');
            if (typeof openResource === 'function') {
                openResource('happiness');
            } else {
                updateStatus('openResource function not available');
            }
        };

        window.debugOpenInventory = function() {
            updateStatus('Opening inventory modal...');
            if (typeof openInventory === 'function') {
                openInventory();
            } else {
                updateStatus('openInventory function not available');
            }
        };

        window.debugOpenAbilities = function() {
            updateStatus('Opening abilities modal...');
            if (typeof openAbilities === 'function') {
                openAbilities();
            } else {
                updateStatus('openAbilities function not available');
            }
        };

        window.debugOpenMenu = function() {
            updateStatus('Opening menu modal...');
            if (typeof togglePause === 'function') {
                togglePause();
            } else {
                updateStatus('togglePause function not available');
            }
        };

        // Mock game object for testing
        window.game = {
            scene: {
                getScene: function(name) {
                    return {
                        bunkerResidents: mockResidents,
                        happiness: mockGameData.happiness,
                        defense: mockGameData.defense,
                        ammo: mockGameData.ammo,
                        comfort: mockGameData.comfort,
                        food: mockGameData.food,
                        water: mockGameData.water,
                        money: mockGameData.money,
                        showToast: function(message) {
                            console.log('Toast:', message);
                        }
                    };
                }
            }
        };

        console.log('Modal test page loaded');
        console.log('Available functions:', {
            openResidents: typeof openResidents,
            openResource: typeof openResource,
            openInventory: typeof openInventory,
            openAbilities: typeof openAbilities,
            togglePause: typeof togglePause,
            closeModal: typeof closeModal,
            openModal: typeof openModal
        });
    </script>
</body>
</html>
