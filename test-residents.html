<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –æ–∫–Ω–∞ –∂–∏—Ç–µ–ª–µ–π</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: #e0e0e0;
            font-family: 'Press Start 2P', monospace;
            font-size: 10px;
        }

        .test-btn {
            background: #2a2a2a;
            border: 2px solid #555555;
            color: #e0e0e0;
            padding: 10px 15px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 10px;
            margin: 5px;
        }

        .test-btn:hover {
            background: #3a3a3a;
            border-color: #D4AF37;
        }

        .mock-game {
            background: #2a2a2a;
            border: 1px solid #444;
            padding: 15px;
            margin: 20px 0;
            font-size: 8px;
        }

        .debug-info {
            background: #2a2a2a;
            border: 1px solid #444;
            padding: 15px;
            margin-top: 20px;
            font-size: 10px;
        }

        .debug-info h3 {
            color: #D4AF37;
            margin-top: 0;
        }
    </style>
</head>
<body>
    <h1>–¢–µ—Å—Ç –æ–∫–Ω–∞ –∂–∏—Ç–µ–ª–µ–π</h1>

    <div>
        <button class="test-btn" onclick="testOpenResidents()">üë• –û—Ç–∫—Ä—ã—Ç—å –æ–∫–Ω–æ –∂–∏—Ç–µ–ª–µ–π</button>
        <button class="test-btn" onclick="testOpenResidentDetail()">üìã –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é</button>
        <button class="test-btn" onclick="closeAllModals()">‚ùå –ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ</button>
    </div>

    <div class="mock-game">
        <h3>Mock Game Data</h3>
        <p>–≠—Ç–æ –∏–º–∏—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–≥—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</p>
    </div>

    <div class="debug-info">
        <h3>Debug Information</h3>
        <p>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫–∏ –≤—ã—à–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π</p>
        <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è –æ—Ç–ª–∞–¥–æ—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π</p>
        <div id="status">Status: Ready</div>
    </div>

    <!-- Include the UI overlay -->
    <div id="game-ui-overlay"></div>

    <script>
        // Mock game scene with bunker residents
        const mockGameScene = {
            bunkerResidents: [
                {
                    id: 1,
                    name: '–ê–ª–µ–∫—Å–µ–π –ü–µ—Ç—Ä–æ–≤',
                    age: 32,
                    gender: '–ú',
                    profession: '–∏–Ω–∂–µ–Ω–µ—Ä',
                    status: '—Ä–∞–±–æ—Ç–∞–µ—Ç',
                    hunger: 85,
                    thirst: 90,
                    energy: 75,
                    health: 100,
                    skills: [
                        { text: '—Ç—Ä—É–¥–æ–ª—é–±–∏–≤—ã–π', positive: true },
                        { text: '–≥–µ–Ω–∏–π', positive: true },
                        { text: '–≤—ã–≥–æ—Ä–µ–≤—à–∏–π', positive: false }
                    ],
                    itemsText: '–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, –∑–∞–ø—á–∞—Å—Ç–∏',
                    admittedAt: 1
                },
                {
                    id: 2,
                    name: '–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞',
                    age: 28,
                    gender: '–ñ',
                    profession: '–¥–æ–∫—Ç–æ—Ä',
                    status: '–æ—Ç–¥—ã—Ö–∞–µ—Ç',
                    hunger: 95,
                    thirst: 88,
                    energy: 60,
                    health: 100,
                    skills: [
                        { text: '—Ç—Ä—É–¥–æ–ª—é–±–∏–≤—ã–π', positive: true },
                        { text: '–≥–µ–Ω–∏–π', positive: true }
                    ],
                    itemsText: '–ú–µ–¥–∏–∫–∞–º–µ–Ω—Ç—ã, –∞–ø—Ç–µ—á–∫–∞',
                    admittedAt: 1
                },
                {
                    id: 3,
                    name: '–î–º–∏—Ç—Ä–∏–π –°–∏–¥–æ—Ä–æ–≤',
                    age: 45,
                    gender: '–ú',
                    profession: '–æ—Ö–æ—Ç–Ω–∏–∫',
                    status: '—Ä–∞–±–æ—Ç–∞–µ—Ç',
                    hunger: 70,
                    thirst: 75,
                    energy: 80,
                    health: 95,
                    skills: [
                        { text: '—Å–∏–ª—å–Ω—ã–π', positive: true },
                        { text: '–º–µ—Ç–∫–∏–π', positive: true }
                    ],
                    itemsText: '–†—É–∂—å—ë, –ø–∞—Ç—Ä–æ–Ω—ã',
                    admittedAt: 2
                }
            ]
        };

        let statusElement = document.getElementById('status');

        function updateStatus(message) {
            statusElement.textContent = 'Status: ' + message;
            console.log('[Test]', message);
        }

        // Load UI overlay
        document.addEventListener('DOMContentLoaded', function() {
            fetch('./src/ui/game-overlay.html')
                .then(response => response.text())
                .then(html => {
                    document.getElementById('game-ui-overlay').innerHTML = html;
                    updateStatus('UI overlay loaded successfully');

                    // Initialize global functions after loading
                    setTimeout(() => {
                        updateStatus('Functions initialized');
                    }, 500);
                })
                .catch(error => {
                    updateStatus('Failed to load UI overlay: ' + error.message);
                });
        });

        function testOpenResidents() {
            updateStatus('Testing openResidents...');

            // Mock window.game object
            window.game = {
                scene: {
                    getScene: function() {
                        return mockGameScene;
                    }
                }
            };

            if (typeof openResidents === 'function') {
                openResidents();
                updateStatus('openResidents executed successfully');
            } else {
                updateStatus('openResidents function not found');
            }
        }

        function testOpenResidentDetail() {
            updateStatus('Testing resident detail...');

            // First populate with mock data
            window.currentResidentsData = mockGameScene.bunkerResidents;

            if (typeof openResidentDetail === 'function') {
                openResidentDetail(0); // Show first resident
                updateStatus('openResidentDetail executed successfully');
            } else {
                updateStatus('openResidentDetail function not found');
            }
        }

        function closeAllModals() {
            const modals = ['population-modal', 'resident-detail-modal'];
            modals.forEach(modalId => {
                if (typeof closeModal === 'function') {
                    closeModal(modalId);
                }
            });
            updateStatus('All modals closed');
        }

        console.log('Test page loaded');
        console.log('Mock residents:', mockGameScene.bunkerResidents);
    </script>
</body>
</html>
